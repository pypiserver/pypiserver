# Release Candidate GitHub Action

name: release_candidate

# TODO(actions):
# - [x] create a new AUTO-RC-<DATE> branch
# - [x] update CHANGES.rst
# - [x] create changes commit
# - [x] push to GH
# - [ ] update README.rst
# - [ ] create readme commit
# - [ ] push to GH
# - [ ] open a PR to `master`

# TODO(general):
# - [ ] setup the action
# - [ ] cleanup the action

on:
  schedule:
    - cron:  '0 0 1 * *'  # each 1st day of the month
  workflow_dispatch:      # on manual trigger


jobs:
  new-rc:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git checkout -b auto-release-candidate-$(date +'%m-%d-%Y')
          git push -u origin auto-release-candidate-$(date +'%m-%d-%Y')

          git status
          git fetch

          ./bin/update_changelog.sh

          git add CHANGES.rst
          git commit -m "chore(rc-changes): update Changes.rst"
          git push